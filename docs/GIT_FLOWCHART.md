# 잘못 커밋했을 때 대처법 - 플로우차트

```
잘못 커밋했어요! 😱
        |
        v
┌─────────────────────────────────────────┐
│  1️⃣ 아직 Push 안 했나요?              │
└─────────────────────────────────────────┘
        |
        ├─── Yes ─────────────────────────┐
        |                                  |
        |                                  v
        |                    ┌─────────────────────────────┐
        |                    │ 커밋 메시지만 잘못?        │
        |                    └─────────────────────────────┘
        |                            |
        |                            ├─── Yes → git commit --amend
        |                            |
        |                            └─── No ──┐
        |                                       v
        |                            ┌─────────────────────┐
        |                            │ 파일을 빼먹었어요? │
        |                            └─────────────────────┘
        |                                       |
        |                                       ├─── Yes → git add 파일
        |                                       |          git commit --amend
        |                                       |
        |                                       └─── No ──┐
        |                                                  v
        |                                       ┌────────────────────┐
        |                                       │ 커밋을 취소하려면 │
        |                                       └────────────────────┘
        |                                                  |
        |                                                  v
        |                                       git reset --soft HEAD~1
        |                                       (변경사항 유지)
        |
        └─── No (이미 Push함) ────────────────┐
                                               v
                                    ┌─────────────────────────┐
                                    │ 협업 중인 브랜치인가요? │
                                    └─────────────────────────┘
                                               |
                                               ├─── Yes → git revert HEAD
                                               |          (안전한 방법!)
                                               |
                                               └─── No  → git reset --hard HEAD~1
                                                          git push -f
                                                          (개인 브랜치만!)
```

---

## 상황별 빠른 참조

### 🔧 커밋 수정하기

| 상황 | 명령어 | 설명 |
|------|--------|------|
| 메시지만 수정 | `git commit --amend -m "새 메시지"` | 마지막 커밋 메시지 변경 |
| 파일 추가 | `git add 파일`<br>`git commit --amend --no-edit` | 마지막 커밋에 파일 추가 |
| 작성자 변경 | `git commit --amend --author="이름 <이메일>"` | 커밋 작성자 정보 변경 |

### ⏪ 커밋 취소하기

| 방법 | 명령어 | 변경사항 | 위험도 | 용도 |
|------|--------|----------|--------|------|
| Soft Reset | `git reset --soft HEAD~1` | ✅ 유지 (Staged) | 🟢 안전 | 커밋만 취소 |
| Mixed Reset | `git reset HEAD~1` | ✅ 유지 (Unstaged) | 🟢 안전 | 커밋+Staging 취소 |
| Hard Reset | `git reset --hard HEAD~1` | ❌ 삭제 | 🔴 위험 | 모두 삭제 |

### 🔄 Push한 커밋 되돌리기

| 상황 | 명령어 | 협업 가능 |
|------|--------|-----------|
| 권장 방법 | `git revert HEAD` | ✅ Yes |
| 강제 방법 | `git reset --hard HEAD~1`<br>`git push -f` | ❌ No (개인 브랜치만) |

---

## 위험도 색상 가이드

- 🟢 **안전**: 복구 가능, 협업 시에도 안전
- 🟡 **주의**: 신중하게 사용, 되돌리기 어려움
- 🔴 **위험**: 데이터 손실 가능, 협업 시 사용 금지

---

## 자주 묻는 질문 (FAQ)

### Q1: 여러 개의 커밋을 하나로 합치고 싶어요

```bash
# 최근 3개 커밋을 하나로 합치기
git reset --soft HEAD~3
git commit -m "합친 커밋 메시지"
```

### Q2: 잘못된 브랜치에 커밋했어요

```bash
# 1. 현재 위치에 새 브랜치 생성
git branch 올바른브랜치

# 2. 원래 브랜치로 이동
git checkout 원래브랜치

# 3. 잘못된 커밋 취소
git reset --hard HEAD~1

# 4. 올바른 브랜치로 이동
git checkout 올바른브랜치
```

### Q3: git push -f는 언제 사용하나요?

**절대로 사용하면 안 되는 경우:**
- 여러 명이 함께 작업하는 브랜치 (main, develop 등)
- 다른 사람이 이미 pull 받은 커밋

**사용 가능한 경우:**
- 본인의 개인 feature 브랜치
- 아무도 pull 받지 않은 커밋
- 혼자 작업하는 저장소

### Q4: git reset vs git revert 차이는?

| 구분 | git reset | git revert |
|------|-----------|------------|
| 방식 | 히스토리 삭제 | 새로운 커밋 생성 |
| 협업 | ❌ 부적합 | ✅ 적합 |
| 히스토리 | 깔끔함 | 모든 기록 유지 |
| 복구 | 어려움 | 쉬움 |

### Q5: 실수로 hard reset을 했어요!

```bash
# 1. 모든 작업 이력 확인
git reflog

# 2. 되돌아갈 시점 찾기 (예: HEAD@{2})
# 3. 해당 시점으로 복구
git reset --hard HEAD@{2}
```

---

## 체크리스트

### 커밋 전 확인사항 ✅

- [ ] 올바른 브랜치에 있나요?
- [ ] git status로 변경사항을 확인했나요?
- [ ] git diff로 실제 변경 내용을 확인했나요?
- [ ] 불필요한 파일이 포함되지 않았나요?
- [ ] 커밋 메시지가 명확한가요?
- [ ] 테스트가 통과하나요?

### Push 전 확인사항 ✅

- [ ] 로컬에서 테스트를 완료했나요?
- [ ] 커밋 히스토리가 깔끔한가요?
- [ ] 민감한 정보(비밀번호, API 키)가 포함되지 않았나요?
- [ ] 올바른 브랜치에 push하려는 건가요?
- [ ] force push가 필요한가요? (필요하다면 주의!)

---

## 🎯 베스트 프랙티스

### 1. 자주 커밋하기
작은 단위로 자주 커밋하면 실수해도 되돌리기 쉽습니다.

### 2. 의미 있는 커밋 메시지
나중에 히스토리를 볼 때 무엇을 변경했는지 쉽게 알 수 있습니다.

### 3. Push 전에 확인
한 번 push하면 되돌리기 어렵습니다. 항상 확인하세요!

### 4. 브랜치 전략 사용
- `main`: 안정적인 릴리스 버전
- `develop`: 개발 중인 버전
- `feature/*`: 새로운 기능 개발
- `hotfix/*`: 긴급 버그 수정

### 5. 정기적으로 동기화
```bash
git fetch origin
git merge origin/main
```

---

## 📚 더 알아보기

- [Git 커밋 가이드 (상세)](GIT_GUIDE.md)
- [Git 빠른 참조 카드](GIT_QUICK_REFERENCE.md)
- [기여 가이드](../CONTRIBUTING.md)

---

**💡 팁**: 이 문서를 북마크하거나 프린트해서 책상에 붙여두세요!
